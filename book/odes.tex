\documentclass{workbook}

\newcommand{\copyrightdate}{2024}

\usepackage{ifxetex}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{hyperxmp} % Embed meta data into the PDF
\hypersetup{%
	hidelinks=true,
	linkcolor = {0 0 1},
	% Metadata to be embedded by hyperxmp
	pdftitle={Ordinary Differential Equations (\jobname)},
	pdfauthor={Bernardo Galvao-Souza, Jason Siefken},
	pdfauthortitle={Author},
	pdfcopyright={Copyright (C) \copyrightdate, Bernardo Galvao-Souza, Jason Siefken},
	pdfsubject={Ordinary Differential Equations textbook/workbook},
	pdfkeywords={ordinary differential equations, ODEs, modeling, vectors, mathematics, textbook},
	pdfurl={https://github.com/siefkenj/IBLODEs/},
	pdflicenseurl={https://creativecommons.org/licenses/by-sa/4.0/},
}

%%%
% import all needed packages and macros
%%%
\usepackage[yyyymmdd]{datetime}
\input{common/preamble.tex}

\usepackage{breqn}

%%%
% Set up the footers to have the correct copyright notices
%%%

\fancypagestyle{siefken}{%
	\rfoot{\footnotesize\it \copyright\,Bernardo Galvao-Souza \& Jason Siefken, \copyrightdate \ \makebox(30,5){\includegraphics[height=1.2em]{by-sa.pdf}}}
	\lfoot{}
	\renewcommand{\headrulewidth}{0pt}
}


%%
% Allow hiding of environments
%%
\usepackage{environ}% http://ctan.org/pkg/environ
\makeatletter
\newcommand{\voidenvironment}[1]{%
  \expandafter\providecommand\csname env@#1@save@env\endcsname{}%
  \expandafter\providecommand\csname env@#1@process\endcsname{}%
  \@ifundefined{#1}{}{\RenewEnviron{#1}{}}%
}
\makeatother
% allow pagebreaks that only display in `standard` mode
\newcommand{\displayonlynewpage}{\begin{displayonly}\newpage\end{displayonly}}
% allow pagebreaks that only display in `book` mode
\newcommand{\bookonlynewpage}{\begin{bookonly}\newpage\end{bookonly}}


%
% Set up the three render modes: standard, instructor, and solutions.
% These render with varying amounts of extra data (like solutions and notes)
%
\newtoggle{instructor}
\newtoggle{standard}
\newtoggle{solutions}
\newtoggle{book}
\newtoggle{slides}
\newcommand{\setinstructor}{
	\toggletrue{instructor}
	\togglefalse{standard}
	\togglefalse{solutions}
	\togglefalse{book}
	\togglefalse{slides}
}
\newcommand{\setstandard}{
	\togglefalse{instructor}
	\toggletrue{standard}
	\togglefalse{solutions}
	\togglefalse{book}
	\togglefalse{slides}
}
\newcommand{\setsolutions}{
	\togglefalse{instructor}
	\togglefalse{standard}
	\toggletrue{solutions}
	\togglefalse{book}
	\togglefalse{slides}
}
\newcommand{\setbook}{
	\togglefalse{instructor}
	\togglefalse{standard}
	\togglefalse{solutions}
	\toggletrue{book}
	\togglefalse{slides}
}
\newcommand{\setslides}{
	\togglefalse{instructor}
	\togglefalse{standard}
	\togglefalse{solutions}
	\togglefalse{book}
	\toggletrue{slides}
}


%
% Infer the document level from the \jobname
%
\usepackage{xstring}
\IfSubStr{\jobname}{\detokenize{book}}{\setbook}{
	\IfSubStr{\jobname}{\detokenize{solutions}}{\setsolutions}{
		\IfSubStr{\jobname}{\detokenize{instructor}}{\setinstructor}{
			\IfSubStr{\jobname}{\detokenize{slides}}{\setslides}{
				\setstandard
			}
		}
	}
}


\setbookoptions{
	twosided = false,
	inline solutions = false,
}


\NewColoredEnvironment{
	name = lesson,
	display name = Lesson,
	banner color = Plum,
	title color = Plum,
	banner on left = true,
	open right = false,
}
\NewColoredEnvironment{
	name = module,
	display name = Module,
	banner color = Turquoise,
	title color = Cerulean,
	definition color = Cerulean,
	theorem color = myorange,
}
\NewColoredEnvironment{
	name = appendix,
	display name = Appendix,
	banner color = LimeGreen,
	title color = LimeGreen!70!Green!80!black,
	definition color = Cerulean,
	theorem color = myorange,
}
\NewColoredEnvironment{
	name = indices,
	display name = Indices,
	banner color = Green,
	title color = Green,
}
\NewColoredEnvironment{
	name = tutorial,
	display name = Tutorial,
	banner color = Peach,
	title color = Peach!80!black,
	emphbox color = Peach,
	% We will print tutorial worksheets back-to-back to save space
	open right = false,
}




\loadgeometry{default}

%
% Hide the non-problem environments
%
\newcommand{\coversubtitle}{} % we override the subtitle in each mode, so make sure the command exists to override.
\iftoggle{instructor}{
	\voidenvironment{module}
	\voidenvironment{appendix}
	\voidenvironment{bookonly}
	\voidenvironment{displayonly}
	\renewcommand{\coversubtitle}{Instructor Guide}
}{}
\iftoggle{solutions}{
	\voidenvironment{module}
	\voidenvironment{appendix}
	\voidenvironment{bookonly}
	\voidenvironment{displayonly}
	\voidenvironment{lesson}
	\voidenvironment{notes}
	\renewcommand{\coversubtitle}{Solutions}
}{}
\iftoggle{standard}{
	\voidenvironment{module}
	\voidenvironment{appendix}
	\voidenvironment{bookonly}
	\voidenvironment{solution}
	\voidenvironment{annotation}
	\voidenvironment{lesson}
	\renewcommand{\coversubtitle}{MAT244 Notes}
	\loadgeometry{default}
}{}
\iftoggle{book}{
	\voidenvironment{displayonly}
	\voidenvironment{solution}
	\voidenvironment{annotation}
	\voidenvironment{lesson}
	\renewcommand{\coversubtitle}{{\hspace{-5pt}\begin{tabular}{l}MAT244 Workbook\\\small\today{} Edition\end{tabular}}}
	\setbookoptions{
		twosided = true,
		inline solutions = false,
	}
	\loadgeometry{book}
}{}
\iftoggle{slides}{
	\voidenvironment{module}
	\voidenvironment{appendix}
	\voidenvironment{bookonly}
	\voidenvironment{solution}
	\voidenvironment{annotation}
	\voidenvironment{lesson}
	\renewcommand{\coversubtitle}{MAT244 Slides}
	\loadgeometry{slides}
	\initSlides
}{}
%\voidenvironment{solution}
%\voidenvironment{annotation}
%\voidenvironment{lesson}
%%\voidenvironment{notes}
%%\voidenvironment{displayonly}

% Allow an index to be created
\makeindex[title=Index of Terms, columns=3]
\makeindex[name=definitions, title=Index of Definitions, columns=3]
\makeindex[name=symbols, title=Index of Symbols, columns=3]

\indexsetup{
	level=\Heading,
	noclearpage
}

\begin{document}
%%
%% Import definitions from definition.tex; all definitions can be restated multiple times
%%

\input{common/definitions.tex}

%%
%% End Definitions
%%




% Needed to get different PDF bookmarks from the TOC entries
\hypersetup{bookmarksdepth=3}

\pagestyle{empty}

\input{common/cover.tex}

\newpage

\begin{bookonly}
	\clearpage
	\hbox{}
	\newpage
	\input{modules/preface.tex}
	\section*{Contributors}
	\input{common/contributors.tex}
	\section*{Dedication}
	\begin{center}
		This book is dedicated to
		\href{https://www.gazettetimes.com/news/local/obituaries/dr-robert-main-burton/article_9c087f07-c005-515a-bb3f-2c9c6a6b7332.html}{\color{blue}Dr.~Bob Burton}---friend and mentor.

		\emph{\large ``Sometimes you have to walk the mystical path with practical feet.''}
	\end{center}
	\newpage
	\mbox{}
	{
		\pagestyle{empty}
		\setcounter{tocdepth}{1}
		\tableofcontents
		\thispagestyle{empty}
	}
	\newpage
	\mbox{}
	\newpage
\end{bookonly}

\setcounter{page}{1}
\pagestyle{siefken}


\addcontentsline{toc}{chapter}{Lessons}

\begin{module}\label{module1}
	\Title{Modeling}

	In this module you will learn
	\begin{itemize}
		\item ??
	\end{itemize}

	\input{modules/module1.tex}
	%\input{modules/module1-exercises.tex}
\end{module}

\begin{slide}

	\question
	You are observing starfish that made their way to a previously uninhabited tide-pool.
	You'd like to predict the year-on-year population of these starfish.

	You start with a simple assumption
	\[
		\# \text{new children per year}\ \sim\ \text{size of current population}
	\]
	\begin{parts}
		\item Come up with a mathematical model for the number of star fish in a given year.
		Your model should
		\begin{itemize}
			\item Define any notation (variables and parameters) you use
			\item Include at least one formula/equation
			\item Explain how your formula/equation relates to the starting assumption
		\end{itemize}
	\end{parts}
\end{slide}

\begin{slide}
	\question
		Let

		\begin{tabular}{rl}
			(Birth Rate) & $K=1.1$ children per starfish per year \\
			(Initial Pop.) & $P_0=10$ star fish
		\end{tabular}

		and define the model \textbf{M$_1$} to be the model for starfish population with
		these parameters.
	\begin{parts}
		\item Simulate the total number of starfish per year using Excel.
	\end{parts}
\end{slide}

\begin{slide}
	\question
	Recall the model \textbf{M$_1$} (from the previous question). 

	Define the model \textbf{M$_1^*$} to be
	\[
		P(t) = P_0 e^{0.742 t}
	\]
	\begin{parts}
		\item Are \textbf{M$_1$} and \textbf{M$_1^*$} different models or the same?
		\item Which of \textbf{M$_1$} or \textbf{M$_1^*$} is better?
		\item List an advantage and a disadvantage for each of \textbf{M$_1$} and \textbf{M$_1^*$}.
	\end{parts}
\end{slide}

\begin{slide}
	\question
	In the model \textbf{M$_1$}, we assumed the starfish had $K$ children at one point during the year.

	\begin{parts}
		\item Create a model \textbf{M$_n$} where the starfish are assumed to have $K/n$ children $n$ times per year (at regular intervals).
		\item Simulate the models \textbf{M$_1$}, \textbf{M$_2$}, \textbf{M$_3$} in Excel. Which grows fastest?
		\item What happens to \textbf{M$_n$} as $n\to\infty$?
	\end{parts}

\end{slide}

\begin{slide}
	\question
	Exploring \textbf{M$_n$}

	We can rewrite the assumptions of \textbf{M$_n$} as follows:
	\begin{itemize}
		\item At time $t$ there are $P_n(t)$ starfish.
		\item $P_n(0)=10$
		\item During the time interval $(t, t+1/n)$ there will be (on average) $K/n$ new children per starfish.
	\end{itemize}

	\begin{parts}
		\item Write an expression for $P_n(t+1/n)$ in terms of $P_n(t)$.
		\item Write an expression for $\Delta P$, the change in population from time $t$ to $t+\Delta t$.
		\item Write an expression for $\frac{\Delta P}{\Delta t}$.
		\item Write down a \emph{differential equation} relating $P'(t)$ to $P(t)$ where $\displaystyle P(t)=\lim_{n\to\infty} P_n(t)$.
	\end{parts}
\end{slide}

\begin{slide}
	\question
	Define the model \textbf{M$_\infty$} by
	\begin{itemize}
		\item $P(0)=10$
		\item $P'(t) = kP(t)$
	\end{itemize}
	and recall the model \textbf{M$_1$} defined by
	\begin{itemize}
		\item $P_1(0)=10$
		\item $P_1(t+1) = KP(t)$ for $t\geq 0$ years and $K=1.1$.
	\end{itemize}


	\begin{parts}
		\item If $k=K=1.1$, does the model \textbf{M$_\infty$} produce the same population estimates as \textbf{M$_1$}?
		\item Suppose that \textbf{M$_1$} accurately predicts the population. Can you find a value of $k$ so that \textbf{M$_\infty$}
		accurately predicts the population?
		\item What are some advantages and disadvantages of the models \textbf{M$_1$} and \textbf{M$_\infty$}?
	\end{parts}
\end{slide}

\begin{slide}
	\question
	After more observations, scientists notice a seasonal effect on starfish. They propose a new model called \textbf{S}:
	\begin{itemize}
		\item $P(0)=10$
		\item $P'(t) = k\cdot P(t)\cdot |\sin(2\pi t)|$
	\end{itemize}
	
	\begin{parts}
		\item Produce a graph of population vs. time for $k=1.1$. 
		\item How do \textbf{S} and \textbf{M$_\infty$} compare (with the same $k$)?
		\item Can you come up with a discrete model for \textbf{S} with a time-step of one year? Why or why not?
	\end{parts}
\end{slide}


\begin{bookonly}
\begin{appendix}\label{APPSLEI}
	\Title{Systems of Linear Equations I}

	In this appendix you will learn
	\begin{itemize}
		\item What a system of linear equations is.
		\item What the solution set to a system of equations is, and what it means for a system of equations
			to be consistent or inconsistent.
		\item How augmented matrices can be used to solve systems of linear equations.
		\item How to apply row reduction to find a unique solution to a system of linear
			equations and to determine if a system of linear equations is consistent or inconsistent.
	\end{itemize}

	\input{modules/appendix1.tex}
	\input{modules/appendix1-exercises.tex}
\end{appendix}


\begin{appendix}
	\PrintExerciseSolutions
\end{appendix}
	\begin{indices}*
		\Title{Indices}

		\printindex[symbols]

		\bigskip
		\printindex

		\bigskip
		\printindex[definitions]
	\end{indices}
\end{bookonly}

\end{document}
